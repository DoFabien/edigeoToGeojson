<!DOCTYPE html>
<html>
<head>
<title>flamebearer</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<style>
    html, body { height: 100%; }
    body { font: 16px "Helvetica Neue", sans-serif; margin: 0; }
    body.hover { background: #cfc; }
    h1 { font-size: 30px; margin: 30px 30px 15px; }
    h1 a { color: black; text-decoration: none; }
    h1 a:hover { text-decoration: underline; }
    #fire-icon { fill: #f53; width: 26px; height: 26px; vertical-align: -1px; }
    #intro { margin: 0 30px; }
    code { font-size: 13px; color: #444; }
    code span { color: #aaa; }
    #canvas { width: 100%; }
    #controls { display: none; }
    #search { margin-right: 10px; }
    #highlight { position: absolute; pointer-events: none; background: #ffffff40; }
    .loaded #intro { display: none; }
    .loaded #header { display: flex; align-items: center; flex-flow: row wrap; padding: 7px 10px; }
    .loaded h1 { font-size: 22px; margin: 0 auto 0 0; flex-shrink: 0; }
    .loaded #fire-icon { width: 20px; height: 20px; }
    .loaded #controls { display: block; flex-shrink: 0; }
    #tooltip { position: absolute; pointer-events: none; background: #ffffff; white-space: nowrap; box-shadow: 1px 2px 4px 0px rgba(0,0,0,0.3); border-radius: 2px; padding: 3px 5px; font: 12px Tahoma, sans-serif; display: none; }
    #tooltip .path { color: #888; font-size: 11px; }
    #tooltip .time { color: #4a4; }
</style>
</head>
<body>

<div id="header">
    <h1><svg id="fire-icon" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 15 15" style="enable-background:new 0 0 15 15;" xml:space="preserve"><path d="M7.5,0.5L5,4.5l-1.5-2 C2.9452,3.4753,0.8036,5.7924,0.8036,8.3036C0.8036,12.002,3.8017,15,7.5,15s6.6964-2.998,6.6964-6.6964 c0-2.5112-2.1416-4.8283-2.6964-5.8036l-1.5,2L7.5,0.5z M7.5,7c0,0,2.5,2.5618,2.5,4.5c0,0.8371-0.8259,2-2.5,2S5,12.3371,5,11.5 C5,9.6283,7.5,7,7.5,7z"/></svg> <a href="https://github.com/mapbox/flamebearer">flamebearer</a></h1>
    <div id="controls">
        <input id="search" placeholder="Search..." />
        <button id="reset">Reset view</button>
    </div>
</div>
<div id="highlight"></div>
<div id="tooltip"></div>
<div id="intro"><!--  --></div>
<canvas id="canvas" height="0"></canvas>

<!--  -->
<script>'use strict';

const introEl = document.getElementById('intro');
const searchEl = document.getElementById('search');
const highlightEl = document.getElementById('highlight');
const tooltipEl = document.getElementById('tooltip');
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');

let names, levels, numTicks;

names = ["(unknown)","~bootstrapNodeJSCore internal/bootstrap/node.js:15:30","~startup internal/bootstrap/node.js:30:19","~setupProcessFatal internal/bootstrap/node.js:474:29","~NativeModule.require internal/bootstrap/loaders.js:140:34","~NativeModule.compile internal/bootstrap/loaders.js:236:44","~(anonymous) internal/async_hooks.js:1:11","~(anonymous) internal/errors.js:1:11","~E internal/errors.js:195:11","(C++) v8::internal::Runtime_DeserializeLazy(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) write","(unknown)","~setupGlobalVariables internal/bootstrap/node.js:342:32","~(anonymous) util.js:1:11","~(anonymous) buffer.js:1:11","(C++) v8::internal::Runtime_LoadIC_Miss(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::Factory::NewCell(v8::internal::Handle<v8::internal::Object>)","~(anonymous) internal/process/main_thread_only.js:1:11","~(anonymous) assert.js:1:11","~(anonymous) fs.js:1:11","(C++) v8::internal::Runtime_StoreIC_Miss(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) __GI___pthread_mutex_unlock","~setupGlobalConsole internal/bootstrap/node.js:401:30","~NativeModule.getCached internal/bootstrap/loaders.js:184:36","(bytecode) ~LdaKeyedProperty","~(anonymous) console.js:1:11","~getStdout internal/process/stdio.js:18:21","~createWritableStdioStream internal/process/stdio.js:158:35","~WriteStream tty.js:75:21","~Socket net.js:222:16","~Duplex _stream_duplex.js:47:16","~Readable _stream_readable.js:144:18","~ReadableState _stream_readable.js:69:23","(C++) v8::internal::Map::SetPrototype(v8::internal::Handle<v8::internal::Map>, v8::internal::Handle<v8::internal::Object>, bool)","~Module.runMain internal/modules/cjs/loader.js:728:26","~Module._load internal/modules/cjs/loader.js:501:24","~Module._resolveFilename internal/modules/cjs/loader.js:546:35","~Module._findPath internal/modules/cjs/loader.js:219:28","(builtin) LoadIC_Uninitialized","~tryModuleLoad internal/modules/cjs/loader.js:534:23","~Module.load internal/modules/cjs/loader.js:589:33","~Module._extensions..js internal/modules/cjs/loader.js:697:37","~readFileSync fs.js:338:22","~tryReadSync fs.js:326:21","~readSync fs.js:472:18","(C++) std::basic_ostream<char, std::char_traits<char> >& std::__ostream_insert<char, std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*, long)","~Module._compile internal/modules/cjs/loader.js:649:37","~(anonymous) ./test.js:1:11","~require internal/modules/cjs/helpers.js:17:19","~Module.require internal/modules/cjs/loader.js:628:36","~(anonymous) ./node_modules/decompress/index.js:1:11","~(anonymous) ./node_modules/graceful-fs/graceful-fs.js:1:11","~tryCreateBuffer fs.js:311:25","~allocUnsafe buffer.js:291:42","~allocate buffer.js:319:18","~createUnsafeBuffer buffer.js:112:28","~createUnsafeArrayBuffer buffer.js:116:33","(builtin) InterpreterPushArgsThenConstruct","~patch ./node_modules/graceful-fs/graceful-fs.js:68:16","~patch ./node_modules/graceful-fs/polyfills.js:25:16","(C++) v8::internal::TransitionsAccessor::Insert(v8::internal::Handle<v8::internal::Name>, v8::internal::Handle<v8::internal::Map>, v8::internal::SimpleTransitionFlag)","~(anonymous) ./node_modules/decompress-tar/index.js:1:11","~(anonymous) ./node_modules/tar-stream/index.js:1:11","~(anonymous) ./node_modules/tar-stream/extract.js:1:11","~(anonymous) ./node_modules/bl/bl.js:1:11","~(anonymous) ./node_modules/readable-stream/duplex.js:1:11","~(anonymous) ./node_modules/readable-stream/readable.js:1:11","~(anonymous) ./node_modules/readable-stream/lib/_stream_readable.js:1:11","~(anonymous) ./node_modules/safe-buffer/index.js:1:11","~copyProps ./node_modules/safe-buffer/index.js:6:20","(C++) v8::internal::Runtime_InterpreterDeserializeLazy(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) mprotect","~(anonymous) ./node_modules/readable-stream/lib/internal/streams/BufferList.js:1:11","~updateChildren internal/modules/cjs/loader.js:95:24","~(anonymous) ./node_modules/tar-stream/pack.js:1:11","~(anonymous) ./node_modules/end-of-stream/index.js:1:11","~(anonymous) ./node_modules/once/once.js:1:11","~runInThisContext vm.js:299:26","~runInThisContext vm.js:91:19","(C++) v8::internal::Runtime_LoadFromSuper(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::Object::GetProperty(v8::internal::LookupIterator*)","~module.exports ./node_modules/pify/index.js:34:38","(builtin) ArrayReduce","~(anonymous) ./node_modules/pify/index.js:59:42","(C++) v8::internal::Runtime_KeyedLoadIC_Miss(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::Map::InstallDescriptors(v8::internal::Handle<v8::internal::Map>, v8::internal::Handle<v8::internal::Map>, int, v8::internal::Handle<v8::internal::DescriptorArray>, v8::internal::Handle<v8::internal::LayoutDescriptor>)","~(anonymous) ./index.js:1:11","~(anonymous) ./generate-ring-from-arc.js:1:11","~(anonymous) ./node_modules/@turf/turf/turf.js:1:11","~earthRadius ./node_modules/@turf/turf/turf.js:1:73","~(anonymous) ./node_modules/@turf/turf/turf.js:5:19","(C++) v8::internal::Runtime_CreateObjectLiteral(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::Map::ShareDescriptor(v8::internal::Handle<v8::internal::Map>, v8::internal::Handle<v8::internal::DescriptorArray>, v8::internal::Descriptor*)","~createCommonjsModule ./node_modules/@turf/turf/turf.js:3140:30","~(anonymous) ./node_modules/@turf/turf/turf.js:3548:51","~orientation ./node_modules/@turf/turf/turf.js:3610:21","(bytecode) ~Ldar","(C++) v8::internal::Runtime_KeyedStoreIC_Miss(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::Object::SetProperty(v8::internal::LookupIterator*, v8::internal::Handle<v8::internal::Object>, v8::internal::LanguageMode, v8::internal::Object::StoreFromKeyed)","(C++) v8::internal::Map::CopyAddDescriptor(v8::internal::Handle<v8::internal::Map>, v8::internal::Descriptor*, v8::internal::TransitionFlag)","(C++) v8::internal::(anonymous namespace)::JSObjectWalkVisitor<v8::internal::(anonymous namespace)::DeprecationUpdateContext>::StructureWalk(v8::internal::Handle<v8::internal::JSObject>)","~_tickCallback internal/process/next_tick.js:41:25","(C++) v8::internal::compiler::MoveOptimizer::FinalizeMoves(v8::internal::compiler::Instruction*)","~read.then.buf ./node_modules/decompress/index.js:95:19","~extractFile ./node_modules/decompress/index.js:22:21","~runPlugins ./node_modules/decompress/index.js:14:20","(builtin) ArrayMap","~Promise.all.opts.plugins.map.x ./node_modules/decompress/index.js:19:38","~input ./node_modules/decompress-tarbz2/index.js:8:24","~Bunzip.decode ./node_modules/seek-bzip/lib/index.js:499:25","~coerceInputStream ./node_modules/seek-bzip/lib/index.js:446:33","~Bunzip._init_block ./node_modules/seek-bzip/lib/index.js:91:40","~Bunzip._get_next_block ./node_modules/seek-bzip/lib/index.js:121:44","~BitReader.read ./node_modules/seek-bzip/lib/bitreader.js:48:36","(bytecode) ~CallProperty0","(bytecode) ~LdaFalse","(bytecode) ~LdaZero","~Buffer buffer.js:174:16","~showFlaggedDeprecation buffer.js:146:32","~isInsideNodeModules internal/util.js:331:29","~structuredStack structured-stack:7:38","(C++) v8::internal::TransitionsAccessor::Initialize()","(bytecode) ~LdaKeyedProperty.Wide","(bytecode) ~StaKeyedProperty.Wide","(stub) StoreFastElementStub","~mtf ./node_modules/seek-bzip/lib/index.js:49:19","(builtin) KeyedLoadIC","BitReader.read ./node_modules/seek-bzip/lib/bitreader.js:48:36","~inputStream.readByte ./node_modules/seek-bzip/lib/index.js:450:34","(bytecode) ~LdaNamedProperty","(bytecode) ~Wide","(bytecode) ~Inc.Wide","(bytecode) ~Sub.Wide","Bunzip._get_next_block ./node_modules/seek-bzip/lib/index.js:121:44","(bytecode) ~BitwiseAndSmi.Wide","(bytecode) ~TestLessThan.Wide","~Bunzip._read_bunzip ./node_modules/seek-bzip/lib/index.js:401:41","~CRC32.updateCRCRun ./node_modules/seek-bzip/lib/crc32.js:97:33","(bytecode) ~TestGreaterThan","Bunzip._read_bunzip ./node_modules/seek-bzip/lib/index.js:401:41","(C++) v8::internal::Runtime_CompileLazy(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::Runtime_StoreCallbackProperty(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::LookupIterator::UpdateProtector() [clone .part.349]","(bytecode) ~Dec.Wide","(bytecode) ~CallProperty1.Wide","(bytecode) ~TestLessThanOrEqual.Wide","(bytecode) ~Jump","(bytecode) ~ToNumeric.Wide","(C++) v8::internal::IC::IC(v8::internal::Isolate*, v8::internal::Handle<v8::internal::FeedbackVector>, v8::internal::FeedbackSlot)","(bytecode) ~Dec","(C++) v8::internal::Builtin_ErrorConstructor(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::TranslatedFrame::Handlify()","(builtin) StoreIC","~outputStream.getBuffer ./node_modules/seek-bzip/lib/index.js:480:36","~alloc buffer.js:278:30","~FastBuffer buffer.js:80:1","(builtin) TypedArrayConstructor","(builtin) TypedArrayInitialize","~input ./node_modules/decompress-tar/index.js:6:24","~module.exports.input ./node_modules/file-type/index.js:3:18","(lib) /lib/x86_64-linux-gnu/libc-2.27.so","~Extract ./node_modules/tar-stream/extract.js:42:24","~BufferList ./node_modules/bl/bl.js:6:21","~Duplex ./node_modules/readable-stream/lib/_stream_duplex.js:64:16","~Writable ./node_modules/readable-stream/lib/_stream_writable.js:250:18","~WritableState ./node_modules/readable-stream/lib/_stream_writable.js:100:23","(builtin) CEntry_Return1_DontSaveFPRegs_ArgvOnStack_NoBuiltinExit","~Writable.end ./node_modules/readable-stream/lib/_stream_writable.js:573:35","~Writable.write ./node_modules/readable-stream/lib/_stream_writable.js:314:37","~writeOrBuffer ./node_modules/readable-stream/lib/_stream_writable.js:384:23","~doWrite ./node_modules/readable-stream/lib/_stream_writable.js:423:17","~Extract._write ./node_modules/tar-stream/extract.js:217:37","~slice buffer.js:1008:40","~adjustOffset buffer.js:991:22","~endReadableNT ./node_modules/readable-stream/lib/_stream_readable.js:1005:23","~emit events.js:140:44","~stream.on ./node_modules/decompress-tar/index.js:22:20","~onunlock ./node_modules/tar-stream/extract.js:71:27","~oncontinue ./node_modules/tar-stream/extract.js:67:29","~Extract._continue ./node_modules/tar-stream/extract.js:209:40","~ondrain ./node_modules/tar-stream/extract.js:85:26","~onheader ./node_modules/tar-stream/extract.js:120:27","~Transform._write ./node_modules/readable-stream/lib/_stream_transform.js:165:39","~Transform._read ./node_modules/readable-stream/lib/_stream_transform.js:179:38","~PassThrough._transform ./node_modules/readable-stream/lib/_stream_passthrough.js:45:45","~afterTransform ./node_modules/readable-stream/lib/_stream_transform.js:77:24","~Transform.push ./node_modules/readable-stream/lib/_stream_transform.js:146:37","(C++) node::RunMicrotasks(v8::FunctionCallbackInfo<v8::Value> const&)","~decompress.then.files ./test.js:5:92","~toGeojson ./index.js:154:28","~getEncoding ./index.js:44:30","~decode ./node_modules/iconv-lite/lib/index.js:30:31","~getDecoder ./node_modules/iconv-lite/lib/index.js:126:39","~getCodec ./node_modules/iconv-lite/lib/index.js:63:35","~(anonymous) ./node_modules/iconv-lite/encodings/index.js:1:11","~Module._nodeModulePaths internal/modules/cjs/loader.js:358:37","(bytecode) ~TestGreaterThanOrEqual","~SBCSDecoder.write ./node_modules/iconv-lite/encodings/sbcs-codec.js:58:39","(bytecode) ~AddSmi","~getActualite ./index.js:66:31","(builtin) StringPrototypeSplit","(C++) v8::internal::Runtime_StringSplit(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::Factory::NewProperSubString(v8::internal::Handle<v8::internal::String>, int, int)","(C++) v8::internal::Factory::NewFixedArrayWithFiller(v8::internal::Heap::RootListIndex, int, v8::internal::Object*, v8::internal::PretenureFlag)","(bytecode) ~StackCheck","(bytecode) ~JumpIfToBooleanFalse","(bytecode) ~CreateRegExpLiteral","getActualite ./index.js:66:31","SBCSDecoder.write ./node_modules/iconv-lite/encodings/sbcs-codec.js:58:39","~parseVEC ./parseVEC.js:185:27","(C++) const>, int)","~PAR ./parseVEC.js:42:12","(builtin) StringEqual","~corToJsonCoords ./parseVEC.js:1:96","(builtin) StringPrototypeMatch","(builtin) RegExpMatchFast","~LNK ./parseVEC.js:149:12","(builtin) ArrayIteratorPrototypeNext","~FEA ./parseVEC.js:105:12","~parseFtpScpNCo ./parseVEC.js:5:33","(C++) v8::internal::Factory::NewJSArray(v8::internal::ElementsKind, v8::internal::PretenureFlag)","(C++) v8::internal::Factory::New(v8::internal::Handle<v8::internal::Map>, v8::internal::PretenureFlag) [clone .constprop.138]","(builtin) CallFunction_ReceiverIsAny","(C++) v8::internal::String::GetFlatContent()","(C++) v8::internal::FindStringIndicesDispatch(v8::internal::Isolate*, v8::internal::String*, v8::internal::String*, std::vector<int, std::allocator<int> >*, unsigned int)","(C++) v8::internal::Runtime_SetProperty(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::SpaceWithLinearArea::StartNextInlineAllocationStep()","~PFE ./parseVEC.js:75:12","PAR ./parseVEC.js:42:12","(C++) __GI___pthread_mutex_lock","FEA ./parseVEC.js:105:12","LNK ./parseVEC.js:149:12","(builtin) RecordWrite","(C++) v8::internal::Heap::RecordWrite(v8::internal::Object*, v8::internal::Object**, v8::internal::Object*)","(builtin) InterpreterEntryTrampoline","(C++) v8::internal::Heap::AllocateRawWithRetryOrFail(int, v8::internal::AllocationSpace, v8::internal::AllocationAlignment)","parseFtpScpNCo ./parseVEC.js:5:33","(C++) memcpy","(C++) v8::internal::IncrementalMarking::WhiteToGreyAndPush(v8::internal::HeapObject*)","(C++) v8::internal::Factory::NewJSArrayStorage(v8::internal::Handle<v8::internal::JSArray>, int, int, v8::internal::ArrayStorageAllocationMode)","(C++) v8::internal::Factory::AllocateRawWithAllocationSite(v8::internal::Handle<v8::internal::Map>, v8::internal::PretenureFlag, v8::internal::Handle<v8::internal::AllocationSite>)","(C++) void v8::internal::String::WriteToFlat<unsigned short>(v8::internal::String*, unsigned short*, int, int)","(C++) v8::internal::Space::AllocationStep(int, unsigned long, int)","(C++) v8::internal::Runtime_ForInEnumerate(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) void std::__final_insertion_sort<v8::base::AtomicElement<v8::internal::Smi*>*, __gnu_cxx::__ops::_Iter_comp_iter<v8::internal::EnumIndexComparator<v8::internal::NameDictionary> > >(v8::base::AtomicElement<v8::internal::Smi*>*, v8::base::AtomicElement<v8::internal::Smi*>*, __gnu_cxx::__ops::_Iter_comp_iter<v8::internal::EnumIndexComparator<v8::internal::NameDictionary> >)","(bytecode) ~ForInNext","~pfeLnk.map.pf ./index.js:224:48","~generateRingFromPFE ./generate-ring-from-arc.js:115:38","~toString native array.js:241:50","~Join native array.js:112:14","~DoJoin native array.js:87:16","(C++) v8::internal::Runtime_StringBuilderJoin(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::Builtin_JsonParse(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::Heap::AllocateRaw(int, v8::internal::AllocationSpace, v8::internal::AllocationAlignment)","(builtin) ForInFilter","(bytecode) ~Mov","(builtin) ArrayFilter","~currentLNK.FTP.filter.p ./index.js:221:56","(bytecode) ~LdaConstant","(builtin) ArrayIsArray","(C++) v8::internal::Runtime_StackGuard(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::IncrementalMarkingRootMarkingVisitor::VisitRootPointer(v8::internal::Root, char const*, v8::internal::Object**)","(C++) double v8::internal::(anonymous namespace)::InternalStringToDouble<unsigned char const*, unsigned char const*>(v8::internal::UnicodeCache*, unsigned char const*, unsigned char const*, int, double)","(C++) void std::__introsort_loop<v8::base::AtomicElement<v8::internal::Smi*>*, long, __gnu_cxx::__ops::_Iter_comp_iter<v8::internal::EnumIndexComparator<v8::internal::NameDictionary> > >(v8::base::AtomicElement<v8::internal::Smi*>*, v8::base::AtomicElement<v8::internal::Smi*>*, long, __gnu_cxx::__ops::_Iter_comp_iter<v8::internal::EnumIndexComparator<v8::internal::NameDictionary> >)","PNO ./parseVEC.js:11:12","(C++) v8::internal::IncrementalMarking::RecordWriteSlow(v8::internal::HeapObject*, v8::internal::HeapObjectReference**, v8::internal::Object*)","(builtin) NumberParseFloat","(C++) v8::internal::Runtime_StringParseFloat(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) const*, unsigned short const*>","(C++) v8::internal::String::Flatten(v8::internal::Handle<v8::internal::String>, v8::internal::PretenureFlag)","(bytecode) ~JumpIfToBooleanTrue","(bytecode) ~LdaSmi","(C++) v8::internal::Factory::AllocateRawArray(int, v8::internal::PretenureFlag)","(bytecode) ~TestEqualStrict","(C++) v8::internal::BinarySearch","(C++) v8::internal::Factory::LookupSingleCharacterStringFromCode(unsigned int)","(bytecode) ~TestEqual","(C++) node::(anonymous namespace)::ExternString<v8::String::ExternalStringResource, unsigned short>::data() const","(builtin) NumberParseInt","(C++) v8::internal::Runtime_StringParseInt(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::Factory::NewNumber(double, v8::internal::PretenureFlag)","~PNO ./parseVEC.js:11:12","(C++) v8::internal::CancelableTaskManager::Register(v8::internal::Cancelable*)","(bytecode) ~CreateArrayLiteral","(C++) v8::internal::StringTable::LookupStringIfExists_NoAllocate(v8::internal::String*)","(C++) v8::internal::Builtin_JsonStringify(int, v8::internal::Object**, v8::internal::Isolate*)","(bytecode) ~SwitchOnSmiNoFeedback","(C++) v8::internal::Factory::InitializeJSObjectFromMap(v8::internal::Handle<v8::internal::JSObject>, v8::internal::Handle<v8::internal::Object>, v8::internal::Handle<v8::internal::Map>)","(C++) v8::internal::Factory::NewRawTwoByteString(int, v8::internal::PretenureFlag)","(C++) v8::internal::JsonStringifier::SerializeDouble(double)","(C++) v8::internal::JsonParser<true>::ParseJsonArray()","Join native array.js:112:14","DoJoin native array.js:87:16","(C++) v8::internal::Runtime_TransitionElementsKind(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::Map::NumberOfFields() const","~convex ./node_modules/@turf/turf/turf.js:4286:16","~concaveman ./node_modules/@turf/turf/turf.js:3927:20","~load ./node_modules/@turf/turf/turf.js:2660:20","~_build ./node_modules/@turf/turf/turf.js:2778:22","~insert ./node_modules/@turf/turf/turf.js:2696:22","~_insert ./node_modules/@turf/turf/turf.js:2868:23","~extend ./node_modules/@turf/turf/turf.js:3065:16","(C++) operator new(unsigned long)","(C++) v8::internal::Builtin_ArrayConcat(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::ElementsAccessor::Concat(v8::internal::Isolate*, v8::internal::Arguments*, unsigned int, unsigned int)","(C++) void v8::internal::LookupIterator::Start<true>()","(builtin) KeyedStoreIC_Megamorphic","~getProperties ./index.js:108:32","(C++) v8::internal::String::ComputeAndSetHash()","(C++) v8::internal::ConsString* v8::internal::String::VisitFlat<v8::internal::IteratingStringHasher>(v8::internal::IteratingStringHasher*, v8::internal::String*, int)","(C++) v8::internal::Runtime_CopyDataProperties(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::LookupIterator::PropertyOrElement(v8::internal::Isolate*, v8::internal::Handle<v8::internal::Object>, v8::internal::Handle<v8::internal::Object>, bool*, v8::internal::LookupIterator::Configuration)","(C++) const*, int)","(C++) v8::internal::(anonymous namespace)::MakeStringThin(v8::internal::String*, v8::internal::String*, v8::internal::Isolate*)","(C++) v8::internal::BaseNameDictionary<v8::internal::NameDictionary, v8::internal::NameDictionaryShape>::CopyEnumKeysTo(v8::internal::Handle<v8::internal::NameDictionary>, v8::internal::Handle<v8::internal::FixedArray>, v8::internal::KeyCollectionMode, v8::internal::KeyAccumulator*)","(bytecode) ~LdaNamedProperty.Wide","(bytecode) ~Star","(C++) v8::internal::LookupIterator::WriteDataValue(v8::internal::Handle<v8::internal::Object>, bool)","(bytecode) ~TestEqual.Wide","(C++) v8::internal::Object::AddDataProperty(v8::internal::LookupIterator*, v8::internal::Handle<v8::internal::Object>, v8::internal::PropertyAttributes, v8::internal::ShouldThrow, v8::internal::Object::StoreFromKeyed)","(C++) v8::internal::TransitionArray::SearchDetails(int, v8::internal::PropertyKind, v8::internal::PropertyAttributes, int*)","(C++) v8::internal::JsonStringifier::SerializeString(v8::internal::Handle<v8::internal::String>)","(C++) v8::internal::FastDtoa(double, v8::internal::FastDtoaMode, int, v8::internal::Vector<char>, int*, int*)","(C++) v8::internal::JsonStringifier::Serialize_"];
levels = [[0,1,0,0,281,11],[0,1,1,0,19,1,0,155,101,0,107,103],[0,1,2,0,19,2,0,1,174,0,154,187,0,107,104],[0,1,3,0,1,4,0,1,12,0,2,22,0,15,34,0,1,175,0,154,188,0,107,105],[0,1,4,0,1,5,0,1,4,0,2,4,0,14,35,0,1,101,0,1,176,0,147,189,0,7,285,0,107,106],[0,1,5,0,1,17,0,1,5,0,1,5,0,1,23,0,1,36,0,13,39,0,1,97,0,1,177,0,1,20,0,1,91,0,18,106,0,1,122,0,1,190,0,4,191,0,6,199,0,1,207,0,89,209,0,2,234,0,4,243,0,1,245,0,1,254,0,1,256,0,1,259,0,1,283,0,1,284,0,1,306,0,4,307,0,5,310,0,1,315,0,1,316,0,1,318,0,1,321,0,1,322,0,5,323,0,107,107],[0,1,6,0,1,4,0,1,13,0,1,25,0,1,24,0,1,37,0,13,40,0,1,102,0,1,178,0,1,20,0,1,91,0,18,246,1,1,9,0,1,192,0,1,197,0,2,208,0,3,200,0,1,204,0,1,205,0,1,206,1,2,129,0,15,200,0,6,211,0,3,212,0,12,216,0,11,218,0,1,222,0,4,225,0,3,227,0,10,228,0,3,230,0,14,231,0,2,264,0,2,273,0,1,281,2,1,244,0,2,263,0,1,314,2,1,257,0,1,260,3,1,306,0,2,308,0,1,313,0,1,311,0,2,317,0,1,319,0,1,320,10,107,108],[0,1,4,0,1,5,0,1,4,0,1,26,1,1,38,0,13,41,1,1,179,2,18,247,1,1,71,0,1,193,0,1,198,2,3,201,6,15,201,0,1,129,0,3,200,0,1,212,0,1,213,3,1,114,0,4,129,0,3,200,0,1,217,0,2,219,0,1,270,0,1,126,0,3,200,0,2,207,0,1,219,0,1,222,0,1,276,0,1,278,0,1,282,1,1,226,0,1,242,0,1,265,0,1,274,0,1,152,0,1,200,0,1,236,2,5,200,0,1,232,0,2,266,0,3,200,1,11,200,0,2,232,1,1,200,2,1,200,8,1,258,0,1,261,4,1,309,0,1,312,16,104,109,0,3,158],[0,1,5,0,1,18,0,1,5,0,1,27,2,1,42,0,12,46,1,1,171,2,1,24,0,2,247,0,6,248,0,4,252,0,1,255,0,3,285,0,1,303,2,1,48,3,1,201,0,1,202,0,1,203,6,4,160,0,3,201,0,1,202,0,3,210,0,1,220,0,1,223,0,1,233,0,1,238,1,3,201,1,1,214,8,3,201,1,1,200,0,1,271,2,3,201,0,2,200,0,1,24,2,1,279,7,1,201,0,1,200,2,5,201,1,2,267,1,2,201,1,11,201,3,1,201,2,1,201,32,1,110,0,51,111,0,5,136,0,46,139,0,1,153,0,1,159,0,1,161,0,1,167],[0,1,7,0,1,4,0,1,14,0,1,28,2,1,43,0,12,47,1,1,180,3,2,295,0,5,249,0,1,291,0,1,253,0,1,262,0,1,287,0,1,290,1,1,160,0,1,289,0,1,305,0,1,304,2,1,49,28,2,201,0,1,221,1,1,215,8,1,201,0,1,220,0,1,269,1,1,201,3,1,224,0,1,275,0,1,277,0,2,201,3,1,280,7,1,265,0,1,201,2,1,201,0,1,229,0,1,239,0,2,240,1,1,267,0,1,268,1,2,201,1,3,201,0,1,220,0,1,223,0,1,224,0,2,235,0,1,238,0,1,241,0,1,269,3,1,223,2,1,203,32,1,70,0,31,112,0,20,133,0,1,126,0,1,137,0,1,140,0,1,149,0,1,152,44,1,15,0,1,119,0,1,117,0,1,156,0,1,161,0,1,168],[0,1,8,0,1,5,0,1,15,0,1,29,2,1,44,0,12,48,1,1,178,3,2,296,0,2,234,0,2,250,0,1,286,0,1,292,11,1,35,45,1,272,6,2,202,12,1,237,64,1,71,0,3,113,0,2,117,0,5,122,0,3,123,0,2,124,0,1,125,0,1,127,0,2,130,0,2,131,0,1,132,0,3,134,0,1,135,0,1,143,0,1,144,0,1,145,0,1,146,0,1,147,21,1,138,0,1,140,46,1,148,0,1,120,0,1,154,0,1,160,0,1,162,0,1,169],[0,1,9,0,1,19,0,1,16,0,1,30,2,1,9,0,12,49,1,1,179,3,1,297,0,1,299,2,2,251,1,1,293,11,1,39,132,1,114,0,1,115,0,1,116,0,2,118,10,1,126,0,1,128,84,1,150,0,1,155,1,1,162,0,1,170],[0,1,10,0,1,20,1,1,31,2,1,45,0,12,35,1,1,171,3,1,298,0,1,300,2,1,241,0,1,288,1,1,294,11,1,40,135,2,119,11,1,129,84,1,151,0,1,156,1,1,163,0,1,171],[1,1,21,1,1,32,3,12,39,1,1,181,3,1,9,0,1,301,17,1,41,135,2,120,97,1,157,1,1,164,0,1,172],[3,1,20,3,12,40,1,1,178,3,1,10,0,1,15,17,1,46,135,1,11,0,1,141,99,1,165,0,1,173],[3,1,33,3,12,41,1,1,179,4,1,302,17,1,194,135,1,121,0,1,142,99,1,20,0,1,9],[7,12,46,1,1,171,22,1,48,236,1,166,0,1,71],[7,6,50,0,6,86,1,1,167,22,1,49],[7,5,48,0,1,81,0,6,48,1,1,168,22,1,35],[7,5,49,0,1,82,0,6,49,1,1,169,22,1,39],[7,5,35,0,1,83,0,6,35,1,1,170,22,1,40],[7,5,39,0,1,84,0,6,39,1,1,182,22,1,195],[7,5,40,0,1,85,0,6,40,1,1,183,22,1,196],[7,5,41,1,6,41,1,1,184],[7,5,46,1,6,46,1,1,185],[7,2,51,0,3,61,1,6,87,1,1,186],[7,1,48,0,1,58,0,3,48,1,6,48,1,1,129],[7,1,49,0,1,59,0,3,49,1,6,49],[7,1,35,0,1,20,0,3,35,1,6,35],[7,1,39,0,1,60,0,3,39,1,6,39],[7,1,40,1,3,40,1,6,40],[7,1,41,1,3,41,1,6,41],[7,1,42,1,3,46,1,6,46],[7,1,52,1,3,62,1,6,88],[7,1,53,1,3,48,1,6,89],[7,1,54,1,3,49,1,6,90],[7,1,55,1,3,35,1,1,20,0,1,70,0,2,91,0,1,93,0,1,97],[7,1,56,1,3,39,1,1,99,0,1,71,0,1,92,0,1,100,0,1,94,0,1,98],[7,1,57,1,3,40,5,1,95],[9,3,41,5,1,96],[9,3,46],[9,2,63,0,1,74],[9,2,48,0,1,48],[9,2,49,0,1,49],[9,2,35,0,1,35],[9,2,39,0,1,39],[9,2,40,0,1,40],[9,2,41,0,1,41],[9,2,46,0,1,46],[9,2,64,0,1,75],[9,2,48,0,1,48],[9,2,49,0,1,49],[9,2,35,0,1,35],[9,2,39,0,1,39],[9,2,40,0,1,40],[9,2,41,0,1,41],[9,2,46,0,1,46],[9,2,65,0,1,76],[9,2,48,0,1,48],[9,2,49,0,1,49],[9,2,35,0,1,35],[9,2,39,0,1,39],[9,2,40,0,1,40],[9,2,41,0,1,41],[9,2,46,0,1,46],[9,2,66,0,1,77],[9,2,48,0,1,78],[9,2,49,0,1,79],[9,2,35,0,1,80],[9,2,39],[9,2,40],[9,2,41],[9,2,46],[9,2,67],[9,2,48],[9,2,49],[9,2,35],[9,2,39],[9,2,40],[9,2,41],[9,2,46],[9,1,68,0,1,72],[9,1,69,0,1,48],[9,1,70,0,1,49],[9,1,71,0,1,35],[10,1,73],[10,1,9],[10,1,10]];
numTicks = 282;

let rangeMin = 0;
let rangeMax = 1;
let topLevel = 0;
let query = '';
let graphWidth, pxPerTick;

const pxPerLevel = 18;
const collapseThreshold = 5;
const hideThreshold = 0.5;
const labelThreshold = 20;

highlightEl.style.height = pxPerLevel + 'px';

if (levels) {
    init();
}

function init() {
    document.body.classList.add('loaded');

    // delta-decode bar positions
    for (const level of levels) {
        let prev = 0;
        for (let i = 0; i < level.length; i += 3) {
            level[i] += prev;
            prev = level[i] + level[i + 1];
        }
    }

    updateFromHash();
    render();
}

window.onhashchange = () => {
    updateFromHash();
    render();
};
canvas.onclick = (e) => {
    const {i, j} = xyToBar(e.offsetX, e.offsetY);
    if (j === -1) return;
    window.location.hash = [i, j].join(',');
    removeHover();
};
document.getElementById('reset').onclick = () => {
    searchEl.value = query = '';
    window.location.hash = '';
    render();
};
window.onresize = render;

searchEl.oninput = (e) => {
    query = e.target.value;
    render();
};

function updateFromHash() {
    const [i, j] = window.location.hash.substr(1).split(',').map(Number);

    if (!isNaN(i) && !isNaN(j)) {
        topLevel = i;
        rangeMin = levels[i][j] / numTicks;
        rangeMax = (levels[i][j] + levels[i][j + 1]) / numTicks;
    } else {
        topLevel = 0;
        rangeMin = 0;
        rangeMax = 1;
    }
}

function tickToX(i) {
    return (i - numTicks * rangeMin) * pxPerTick;
}

function render() {
    if (!levels) return;

    graphWidth = canvas.width = canvas.clientWidth;
    canvas.height = pxPerLevel * (levels.length - topLevel);
    canvas.style.height = canvas.height + 'px';

    if (devicePixelRatio > 1) {
        canvas.width *= 2;
        canvas.height *= 2;
        ctx.scale(2, 2);
    }

    pxPerTick = graphWidth / numTicks / (rangeMax - rangeMin);

    ctx.textBaseline = 'middle';
    ctx.font = '10px Tahoma, sans-serif';
    ctx.strokeStyle = 'white';

    for (let i = 0; i < levels.length - topLevel; i++) {
        const level = levels[topLevel + i];

        for (let j = 0; j < level.length; j += 3) {
            const barIndex = level[j];
            const x = tickToX(barIndex);
            const y = i * pxPerLevel;
            let numBarTicks = level[j + 1];

            const inQuery = query && (names[level[j + 2]].indexOf(query) >= 0) || false;

            // merge very small blocks into big "collapsed" ones for performance
            const collapsed = numBarTicks * pxPerTick <= collapseThreshold;
            if (collapsed) {
                while (
                    j < level.length - 3 &&
                    barIndex + numBarTicks === level[j + 3] &&
                    level[j + 4] * pxPerTick <= collapseThreshold &&
                    (inQuery === (query && (names[level[j + 5]].indexOf(query) >= 0) || false))
                ) {
                    j += 3;
                    numBarTicks += level[j + 1];
                }
            }

            const sw = numBarTicks * pxPerTick - (collapsed ? 0 : 0.5);
            const sh = pxPerLevel - 0.5;

            if (x < -1 || x + sw > graphWidth + 1 || sw < hideThreshold) continue;

            ctx.beginPath();
            ctx.rect(x, y, sw, sh);

            const ratio = numBarTicks / numTicks;

            if (!collapsed) {
                ctx.stroke();
                const intensity = Math.min(1, ratio * Math.pow(1.16, i) / (rangeMax - rangeMin));
                const h = 50 - 50 * intensity;
                const l = 65 + 7 * intensity;
                ctx.fillStyle = inQuery ? 'lightgreen' : `hsl(${h}, 100%, ${l}%)`;
            } else {
                ctx.fillStyle = inQuery ? 'lightgreen' : '#eee';
            }
            ctx.fill();

            if (!collapsed && sw >= labelThreshold) {

                const percent = Math.round(10000 * ratio) / 100;
                const name = `${names[level[j + 2]]} (${percent}%, ${numBarTicks} samples)`;

                ctx.save();
                ctx.clip();
                ctx.fillStyle = 'black';
                ctx.fillText(name, Math.max(x, 0) + 1, y + sh / 2);
                ctx.restore();
            }
        }
    }
}

// pixel coordinates to bar coordinates in the levels array
function xyToBar(x, y) {
    const i = Math.floor(y / pxPerLevel) + topLevel;
    const j = binarySearchLevel(x, levels[i]);
    return {i, j};
}

// binary search of a block in a stack level
function binarySearchLevel(x, level) {
    let i = 0;
    let j = level.length - 3;
    while (i <= j) {
        const m = 3 * ((i / 3 + j / 3) >> 1);
        const x0 = tickToX(level[m]);
        const x1 = tickToX(level[m] + level[m + 1]);
        if (x0 <= x && x1 >= x) {
            return x1 - x0 > collapseThreshold ? m : -1;
        }
        if (x0 > x) {
            j = m - 3;
        } else {
            i = m + 3;
        }
    }
    return -1;
}

if (window.orientation === undefined) {
    canvas.onmousemove = addHover;
    canvas.onmouseout = window.onscroll = removeHover;
}

function removeHover() {
    canvas.style.cursor = '';
    highlightEl.style.display = 'none';
    tooltipEl.style.display = 'none';
}

function addHover(e) {
    const {i, j} = xyToBar(e.offsetX, e.offsetY);

    if (j === -1 || e.offsetX < 0 || e.offsetX > graphWidth) {
        removeHover();
        return;
    }

    canvas.style.cursor = 'pointer';

    const level = levels[i];
    const x = tickToX(level[j]);
    const y = (i - topLevel) * pxPerLevel;
    const sw = tickToX(level[j] + level[j + 1]) - x;

    highlightEl.style.display = 'block';
    highlightEl.style.left = x + 'px';
    highlightEl.style.top = (canvas.offsetTop + y) + 'px';
    highlightEl.style.width = sw + 'px';

    const numBarTicks = level[j + 1];
    const percent = Math.round(10000 * numBarTicks / numTicks) / 100;
    const time = `<span class="time">(${percent}%, ${numBarTicks} samples)</span>`;
    let content = names[level[j + 2]];
    if (content[0] !== '(') content = content.replace(' ', ` ${time}<br><span class="path">`) + '</span>';
    else content += ` ${time}`;

    tooltipEl.innerHTML = content;
    tooltipEl.style.display = 'block';
    tooltipEl.style.left = (Math.min(e.offsetX + 15 + tooltipEl.clientWidth, graphWidth) - tooltipEl.clientWidth) + 'px';
    tooltipEl.style.top = (canvas.offsetTop + e.offsetY + 12) + 'px';
}

// (function frame() { if (levels) render(); requestAnimationFrame(frame); })();


</script>
</body>
</html>
